<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Управление матчами</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/edit_matches.css') }}">
</head>
<body>
    <div class="admin-container">
        <a href="{{ url_for('home') }}">На главную</a>
        <h2 style="text-align: center; margin-bottom: 20px;">Управление матчами</h2>

        <div style="margin-bottom: 30px;">
            <h3>Добавить новый матч</h3>
            <form method="POST" action="{{ url_for('add_match') }}" class="match-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Хозяева:</label>
                        <select name="home_team" required>
                            {% for club in clubs %}
                                <option value="{{ club }}">{{ club }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Гости:</label>
                        <select name="away_team" required>
                            {% for club in clubs %}
                                <option value="{{ club }}">{{ club }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Дата и время:</label>
                        <input type="datetime-local" name="match_date" required>
                    </div>

                    <div class="form-group">
                        <label>Номер тура:</label>
                        <input type="number" name="tour_number" min="1" required>
                    </div>
                </div>

                <button type="submit" class="btn-submit">Добавить матч</button>
            </form>
        </div>

        {% for tour_number, matches in matches_by_tour.items() %}
        <div class="tour-section">
            <h3>Тур {{ tour_number }}</h3>

            <div class="matches-list">
                {% for match in matches %}
                <form method="POST" action="{{ url_for('update_match', match_id=match.id) }}" class="match-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Хозяева:</label>
                            <select name="home_team">
                                {% for club in clubs %}
                                    <option value="{{ club }}" {% if club == match.home_team %}selected{% endif %}>{{ club }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="score-inputs">
                            <input type="number" name="home_score" min="0" value="{{ match.home_score if match.home_score is not none }}">
                            <span>:</span>
                            <input type="number" name="away_score" min="0" value="{{ match.away_score if match.away_score is not none }}">
                        </div>

                        <div class="form-group">
                            <label>Гости:</label>
                            <select name="away_team">
                                {% for club in clubs %}
                                    <option value="{{ club }}" {% if club == match.away_team %}selected{% endif %}>{{ club }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Дата и время:</label>
                            <input type="datetime-local" name="match_date"
                                   value="{{ match.match_date.strftime('%Y-%m-%dT%H:%M') }}">
                        </div>

                        <div class="form-group">
                            <label>Номер тура:</label>
                            <input type="number" name="tour_number" min="1" value="{{ match.tour_number }}">
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-update">Обновить</button>
                        <form method="POST" action="{{ url_for('delete_match', match_id=match.id) }}" style="display: inline;">
                        <button type="submit" class="btn-delete"
                         onclick="return confirm('Вы уверены, что хотите удалить этот матч?')">
                              Удалить
                        </button>
                        </form>
                    </div>
                </form>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</body>
</html>
